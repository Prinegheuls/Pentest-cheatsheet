# ADCS

Active Directory Certificate Services (AD CS) is a Microsoft Windows server role that provides a public key infrastructure (PKI). It allows you to create, manage, and distribute digital certificates, which are used to secure communication and transactions across a network.

# Find the ADCS component(s)

```
crackmapexec ldap domain.lab -u username -p password -M adcs
```
```
ldapsearch -H ldap://dc_IP -x -LLL -D 'CN=<user>,OU=Users,DC=domain,DC=local' -w '<password>' -b "CN=Enrollment Services,CN=Public Key Services,CN=Services,CN=CONFIGURATION,DC=domain,DC=local" dNSHostName
```
```
certutil.exe -config - -ping, certutil -dump
```

# Persistence

Certificates are still usable even if the user or computer resets their password!



# More informations / credits
- https://hideandsec.sh/books/cheatsheets-82c/page/active-directory-certificate-services <3
- https://www.thehacker.recipes/a-d/movement/ad-cs
- https://heartburn.dev/exploiting-active-directory-certificate-services-esc11-walkthrough/
- https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation
