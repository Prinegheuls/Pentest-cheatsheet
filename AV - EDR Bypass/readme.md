# AV - EDR Bypass
This is a notebook of my quest of learning how to bypass defence. 

## Concept

- AV :
- EDR :

## Bypass methods

### Basic evasion (ex: AV)

#### Payload obsfucation

- Encoded payloads (Base, UUID, IPv4-v6, Morse, etc.)  
- Cyphered payload (XOR, AES, RC4, CEASAR, etc.)

#### Staged shellcode

Host a malicious code on the remote service, fetch it and execute it. Cookbook is given in the "Shellcode execution" part.

- Staging with HTTP/HTTPS
- Staging with registry 

### Advanced evasion (ex: EDR-XDR)

#### API Unhooking 

Hooks are installed by EDRs in the Windows API DLL to monitor the called functions and check for malicious behaviors. The idea here is to parse the Windows API DLLs (kernel32.dll, NTDDL.dll) and unhook EDR's hooks.  

#### Direct/Indirect syscall

- Direct syscall:  https://redops.at/en/blog/direct-syscalls-a-journey-from-high-to-low
- Indirect syscall:  https://redops.at/en/blog/direct-syscalls-vs-indirect-syscalls



## How to install EDR to POC bypasses
### Elastic EDR
To test Elastic EDR, it is possible to install the following docker version and ask for a 30-day prenium trial:

- github : https://github.com/peasead/elastic-container

