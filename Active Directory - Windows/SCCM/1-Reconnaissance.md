# Reconnaissance
## Unauthenticated recon

- Using nmap and openssl

[official ports list](https://learn.microsoft.com/en-us/mem/configmgr/core/plan-design/hierarchy/ports)
  
```txt
# search sccm
nmap -p 80,443,445,1433,10123,8530,8531 -sV 192.168.33.11-12
# search pxe
nmap -p 67,68,69,4011,547 -sU 192.168.33.11 
```

It is then possible to identify the "SMS Provider" component by analysing TLS certificate, with openssl:
```
openssl s_client -connect 192.168.33.11:10123
```

- Using RPC

Connect to emmaper pipe, list all available rpc call and search for "Windows Deployment Services Control Protocol":
```
rpcdump.py [target] |grep Protocol |grep -v 'N/A' | grep 'WDSC'
```

## Authenticated recon

- Using sccmhunter.py
```
#> Using LDAP
sccmhunter.py find -u $USER -p $PASSWORD -d $DOMAIN -dc-ip $DC
#> Using SMB
sccmhunter.py smb -u $USER -p $PASSWORD -d $DOMAIN -dc-ip $DC -save
#> Then show all
sccmhunter.py show -all
```

- Using ldeep
```
ldeep ldap -u [USER] -p [PASSWORD] -d [domain.local] -s [ldap://DC] sccm
```

- Basic recon with SMB shares
```
nxc smb [SCCM] -u [USER] -p [PASSWORD] -d [domain.local] --shares
``` 
